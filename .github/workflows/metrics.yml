name: Metrics Final Fix
on:
  schedule: [{cron: "0 0 * * *"}]
  workflow_dispatch:
  push: {branches: ["master", "main"]}

jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: lowlighter/metrics@master 
        with:
          token: ${{ secrets.METRICS_TOKEN }}

          # Configuración base
          user: kodergoq
          template: classic
          base: header, community, repositories, metadata
          config_timezone: America/Mexico_City

          # LENGUAJES: Ignoramos lo que no es core para tu perfil
          plugin_languages: yes
          plugin_languages_ignored: html, css, scss, ruby
          plugin_languages_details: bytes-size, percentage
          plugin_languages_limit: 8
          
          # ACHIEVEMENTS: Lo desactivamos temporalmente 
          # porque el plugin actual tiene el bug de "Projects Classic"
          plugin_achievements: no 

          # HÁBITOS Y ACTIVIDAD: 
          # Aumentamos el rango a 30 días y quitamos filtros estrictos
          # para evitar el error de "undefined" si hay poca actividad
          plugin_habits: yes
          plugin_habits_from: 200
          plugin_habits_days: 30        # Más días para encontrar actividad
          plugin_habits_facts: yes
          plugin_habits_charts: yes
          
          plugin_activity: yes
          plugin_activity_limit: 5
          plugin_activity_days: 0       # 0 significa "sin límite" para encontrar algo
          # Quitamos el filtro para que tome cualquier evento (star, fork, push)
